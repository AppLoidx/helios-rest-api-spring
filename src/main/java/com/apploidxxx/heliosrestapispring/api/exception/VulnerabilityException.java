package com.apploidxxx.heliosrestapispring.api.exception;

import com.apploidxxx.heliosrestapispring.api.model.ErrorMessage;
import com.apploidxxx.heliosrestapispring.api.util.ErrorResponseFactory;

import javax.servlet.http.HttpServletResponse;

/**
 * @author Arthur Kupriyanov
 */
public class VulnerabilityException extends ResponsibleException{
    private ErrorMessage errorMessage;

    public VulnerabilityException(String message) {
        super(message);
    }
    public VulnerabilityException(String message, ErrorMessage errorMessage) {
        super(message);
        this.errorMessage = errorMessage;
    }

    public ErrorMessage getResponse(HttpServletResponse res){
        if (errorMessage != null) return errorMessage;
        return ErrorResponseFactory
                .getInvalidParamErrorResponse(
                        "vulnerability",
                        "founded vulnerability warning in your request params", res);
    }
}
